Running on desktop23:
stdin: is not a tty
/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/sklearn/utils/validation.py:37: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
  LARGE_SPARSE_SUPPORTED = LooseVersion(scipy_version) >= '0.14.0'
Using the specified args:
Namespace(cfg_path='/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/config/config.json', device_ids='0', logtofile=False, num_workers=2, pre_train=None, resume=0, save_path='/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/logdirs/logdir-30k-2', verbose=True)
{
    "base_path": "/home/data_shares/purrlab/CheXpert/CheXpert-v1.0-small",
    "train_csv": "/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/subsets2/30k-2-train.csv",
    "dev_csv": "/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/subsets2/30k-2-val.csv",
    "backbone": "densenet121",
    "width": 512,
    "height": 512,
    "long_side": 512,
    "fix_ratio": true,
    "pixel_mean": 128.0,
    "pixel_std": 64.0,
    "use_pixel_std": true,
    "use_equalizeHist": true,
    "use_transforms_type": "Aug",
    "gaussian_blur": 3,
    "border_pad": "pixel_mean",
    "num_classes": [
        1
    ],
    "batch_weight": true,
    "enhance_index": [
        2,
        6
    ],
    "enhance_times": 1,
    "pos_weight": [
        1
    ],
    "train_batch_size": 32,
    "dev_batch_size": 32,
    "pretrained": true,
    "log_every": 10,
    "test_every": 100,
    "epoch": 10,
    "norm_type": "BatchNorm",
    "global_pool": "PCAM",
    "fc_bn": true,
    "attention_map": "FPA",
    "lse_gamma": 0.5,
    "fc_drop": 0,
    "optimizer": "Adam",
    "criterion": "BCE",
    "lr": 0.0001,
    "lr_factor": 0.1,
    "lr_epochs": [
        2
    ],
    "momentum": 0.9,
    "weight_decay": 0.0,
    "best_target": "auc",
    "save_top_k": 3,
    "save_index": [
        0
    ]
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─DenseNet: 1-1                               [-1, 1024, 16, 16]        --
|    └─Sequential: 2-1                        [-1, 1024, 16, 16]        --
|    |    └─Conv2d: 3-1                       [-1, 64, 256, 256]        9,408
|    |    └─BatchNorm2d: 3-2                  [-1, 64, 256, 256]        128
|    |    └─ReLU: 3-3                         [-1, 64, 256, 256]        --
|    |    └─MaxPool2d: 3-4                    [-1, 64, 128, 128]        --
|    |    └─_DenseBlock: 3-5                  [-1, 256, 128, 128]       335,040
|    |    └─_Transition: 3-6                  [-1, 128, 64, 64]         33,280
|    |    └─_DenseBlock: 3-7                  [-1, 512, 64, 64]         919,680
|    |    └─_Transition: 3-8                  [-1, 256, 32, 32]         132,096
|    |    └─_DenseBlock: 3-9                  [-1, 1024, 32, 32]        2,837,760
|    |    └─_Transition: 3-10                 [-1, 512, 16, 16]         526,336
|    |    └─_DenseBlock: 3-11                 [-1, 1024, 16, 16]        2,158,080
|    |    └─BatchNorm2d: 3-12                 [-1, 1024, 16, 16]        2,048
├─AttentionMap: 1-2                           [-1, 1024, 16, 16]        --
|    └─FPAModule: 2-2                         [-1, 1024, 16, 16]        --
|    |    └─Sequential: 3-13                  [-1, 1024, 1, 1]          1,051,648
|    |    └─Conv2dNormRelu: 3-14              [-1, 1024, 16, 16]        1,051,648
|    |    └─Conv2dNormRelu: 3-15              [-1, 1, 8, 8]             50,179
|    |    └─Conv2dNormRelu: 3-16              [-1, 1, 4, 4]             28
|    |    └─Conv2dNormRelu: 3-17              [-1, 1, 2, 2]             12
|    |    └─Conv2dNormRelu: 3-18              [-1, 1, 2, 2]             12
|    |    └─Conv2dNormRelu: 3-19              [-1, 1, 4, 4]             28
|    |    └─Conv2dNormRelu: 3-20              [-1, 1, 8, 8]             52
├─Conv2d: 1-3                                 [-1, 1, 16, 16]           1,025
├─GlobalPool: 1-4                             [-1, 1024, 1, 1]          --
|    └─PcamPool: 2-3                          [-1, 1024, 1, 1]          --
├─BatchNorm2d: 1-5                            [-1, 1024, 1, 1]          2,048
├─Conv2d: 1-6                                 [-1, 1, 1, 1]             (recursive)
===============================================================================================
Total params: 9,110,536
Trainable params: 9,110,536
Non-trainable params: 0
Total mult-adds (G): 2.27
===============================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 150.01
Params size (MB): 34.75
Estimated Total Size (MB): 187.76
===============================================================================================
Traceback (most recent call last):
  File "bin/train.py", line 468, in <module>
    main()
  File "bin/train.py", line 464, in main
    run(args)
  File "bin/train.py", line 354, in run
    summary_writer, best_dict, dev_header)
  File "bin/train.py", line 91, in train_epoch
    image, target = next(dataiter)
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 345, in __next__
    data = self._next_data()
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 856, in _next_data
    return self._process_data(data)
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 881, in _process_data
    data.reraise()
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/_utils.py", line 394, in reraise
    raise self.exc_type(msg)
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py", line 178, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/pmen/.conda/envs/chtrain/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/bin/../data/dataset.py", line 44, in __getitem__
    image = GetTransforms(image, type=self.cfg.use_transforms_type)
  File "/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/bin/../data/imgaug.py", line 35, in GetTransforms
    image = Aug(image)
  File "/home/pmen/Shortcuts-Problem-in-Medical-Image-Analysis/shortcuts-chest-xray/bin/../data/imgaug.py", line 16, in Aug
    scale=(0.95, 1.05), fill=128)
TypeError: __init__() got an unexpected keyword argument 'fill'

